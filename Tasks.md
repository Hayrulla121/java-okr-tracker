# Выполненные задачи - OKR Tracking System

## Модуль аутентификации и авторизации

### OKR-001: Реализация JWT аутентификации
**Статус:** Выполнено
**Описание:** Реализована stateless JWT аутентификация с 24-часовым сроком действия токена.
- Генерация и валидация JWT токенов
- Фильтр аутентификации на уровне запросов
- Безопасное хранение паролей с BCrypt хешированием

### OKR-002: Ролевая модель доступа (RBAC)
**Статус:** Выполнено
**Описание:** Реализована система ролей с 6 уровнями доступа:
- ADMIN - полный доступ к системе
- DIRECTOR - оценка и управление подразделениями
- HR - оценки HR и управление пользователями
- BUSINESS_BLOCK - оценки бизнес-блока
- DEPARTMENT_LEADER - управление OKR департамента
- EMPLOYEE - просмотр собственных OKR

### OKR-003: Регистрация и авторизация пользователей
**Статус:** Выполнено
**Описание:** API endpoints для входа, регистрации и получения информации о текущем пользователе.
- POST /api/auth/login - авторизация
- POST /api/auth/register - регистрация (только ADMIN)
- GET /api/auth/me - информация о текущем пользователе

---

## Модуль организационной структуры

### OKR-004: Управление дивизионами (Division)
**Статус:** Выполнено
**Описание:** CRUD операции для верхнего уровня организационной структуры.
- Создание, редактирование, удаление дивизионов
- Назначение лидера дивизиона
- Каскадное удаление связанных департаментов
- Иерархическое дерево дивизионов

### OKR-005: Управление департаментами (Department)
**Статус:** Выполнено
**Описание:** CRUD операции для департаментов внутри дивизионов.
- Привязка департамента к дивизиону
- Назначение лидера департамента
- Many-to-many связь пользователей с департаментами
- Контроль доступа на редактирование

### OKR-006: Назначение пользователей в департаменты
**Статус:** Выполнено
**Описание:** Функционал назначения и удаления пользователей из департаментов.
- POST /api/users/{id}/departments - назначение
- DELETE /api/users/{id}/departments/{deptId} - удаление
- Получение списка пользователей департамента

---

## Модуль OKR

### OKR-007: Управление целями (Objectives)
**Статус:** Выполнено
**Описание:** CRUD операции для целей с поддержкой весов.
- Создание целей на уровне департамента
- Создание индивидуальных целей для сотрудников
- Весовое распределение целей (0-100%)
- Каскадное удаление ключевых результатов

### OKR-008: Управление ключевыми результатами (Key Results)
**Статус:** Выполнено
**Описание:** CRUD операции для ключевых результатов с тремя типами метрик.
- HIGHER_BETTER - чем больше, тем лучше (рост продаж)
- LOWER_BETTER - чем меньше, тем лучше (уровень ошибок)
- QUALITATIVE - буквенные оценки (A-E)

### OKR-009: Пороговая система оценивания
**Статус:** Выполнено
**Описание:** 5-уровневая система оценки ключевых результатов.
- Below (Ниже ожиданий)
- Meets (Соответствует)
- Good (Хорошо)
- Very Good (Очень хорошо)
- Exceptional (Исключительно)

---

## Модуль оценок

### OKR-010: Оценки от директора
**Статус:** Выполнено
**Описание:** Система оценивания директором.
- Шкала UI: 1-5 звезд
- Backend диапазон: 4.25-5.0
- Вес в итоговой оценке: 20%

### OKR-011: Оценки от HR
**Статус:** Выполнено
**Описание:** Система оценивания HR-отделом.
- Шкала: буквенные оценки A-D (A - наивысшая)
- Динамическое отображение на уровни оценок
- Вес в итоговой оценке: 20%

### OKR-012: Оценки от бизнес-блока
**Статус:** Выполнено
**Описание:** Система оценивания бизнес-блоком.
- Шкала: 1-5 числовой рейтинг
- Вес в итоговой оценке: 20%

### OKR-013: Формула расчета итоговой оценки
**Статус:** Выполнено
**Описание:** Алгоритм расчета финальной оценки.
- С 4 источниками: OKR (40%) + Директор (20%) + HR (20%) + Бизнес-блок (20%)
- Без бизнес-блока: OKR (60%) + Директор (20%) + HR (20%)

### OKR-014: Статусы оценок
**Статус:** Выполнено
**Описание:** Workflow статусов оценок.
- DRAFT - черновик
- SUBMITTED - отправлено
- APPROVED - утверждено
- Предотвращение дублирования оценок

---

## Модуль динамического скоринга

### OKR-015: Динамическая конфигурация уровней оценок
**Статус:** Выполнено
**Описание:** Настраиваемые пороги и цвета для уровней оценок.
- Конфигурируемый диапазон min-max (не привязан к 0-5)
- Название уровня, значение, цвет отображения
- Порядок отображения и флаг по умолчанию
- Thread-local кэширование для производительности

### OKR-016: API управления уровнями оценок
**Статус:** Выполнено
**Описание:** Endpoints для настройки скоринга.
- GET /api/score-levels - получение текущей конфигурации
- PUT /api/score-levels - обновление уровней
- POST /api/score-levels/reset - сброс к значениям по умолчанию

---

## Модуль управления пользователями

### OKR-017: CRUD операции для пользователей
**Статус:** Выполнено
**Описание:** Полный набор операций управления пользователями.
- Создание, редактирование, удаление пользователей
- Активация/деактивация аккаунтов
- Отслеживание последнего входа

### OKR-018: Профили пользователей
**Статус:** Выполнено
**Описание:** Расширенные профили с дополнительной информацией.
- Фото профиля
- Должность (job title)
- Номер телефона
- Биография

### OKR-019: Загрузка фото профиля
**Статус:** Выполнено
**Описание:** Функционал загрузки аватаров пользователей.
- Поддержка форматов: JPEG, PNG, GIF
- Максимальный размер: 5MB
- Автоматическая очистка при замене фото
- Хранение в /uploads/profile-photos/

---

## Модуль экспорта и отчетов

### OKR-020: Экспорт в Excel
**Статус:** Выполнено
**Описание:** Генерация Excel отчетов по департаментам.
- Профессиональное форматирование
- GET /api/export/excel
- Доступно всем авторизованным пользователям

---

## Модуль демо-данных

### OKR-021: Загрузка тестовых данных
**Статус:** Выполнено
**Описание:** Endpoint для создания демо-данных.
- POST /api/demo/load
- 7 пользователей с разными ролями
- Департаменты с примерами целей и ключевых результатов
- Очистка существующих данных перед загрузкой

---

## Инфраструктура и конфигурация

### OKR-022: Настройка Spring Security
**Статус:** Выполнено
**Описание:** Конфигурация безопасности приложения.
- JWT фильтр аутентификации
- CORS настройка для localhost:3000 и localhost:5173
- Method-level авторизация (@PreAuthorize)

### OKR-023: Настройка базы данных H2
**Статус:** Выполнено
**Описание:** Конфигурация встроенной базы данных.
- Файловое хранение в ./data/okrdb
- Hibernate/JPA ORM
- Batch fetch size: 20

### OKR-024: Глобальная обработка исключений
**Статус:** Выполнено
**Описание:** Централизованная обработка ошибок.
- GlobalExceptionHandler
- Стандартизированный формат ответа ErrorResponse
- Корректные HTTP статус коды

### OKR-025: Сервисы проверки доступа
**Статус:** Выполнено
**Описание:** Гранулярный контроль прав доступа.
- DepartmentAccessService - проверка доступа к департаментам
- DivisionAccessService - проверка доступа к дивизионам
- Флаг can-edit-assigned-departments

---

## Статистика проекта

| Метрика | Значение |
|---------|----------|
| Контроллеров | 6 |
| Сервисов | 10 |
| Сущностей | 11 |
| Репозиториев | 7 |
| DTO классов | 25+ |
| API endpoints | 35+ |

---

## Технологический стек

- **Framework:** Spring Boot 4.1.0-M1
- **Java:** 17
- **База данных:** H2 (embedded)
- **Аутентификация:** JWT (JJWT 0.11.5)
- **Безопасность:** Spring Security
- **ORM:** Hibernate/JPA
- **Excel:** Apache POI 5.2.5
- **Утилиты:** Lombok

---

*Документ создан: 01.02.2026*
